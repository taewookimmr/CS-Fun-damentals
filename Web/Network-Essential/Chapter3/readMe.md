## TCP/IP 통신구조

네크워크의 본질적 기능, 미시적 관점에서 필요한 내용

---
### 1. 가변길이 서브넷 마스크

* 서브넷 별로 서브넷 마스크의 길이를 다르게 할 수 있다.
* 가변길이 서브넷 마스크 : VLSM(Variable, Length Subnet Masking)

* subnet mask의 len을 자유롭게 바꿀 수 있다면, 서브넷 별로 접속할 컴퓨터의 수를 유연하게 결정할 수 있다. 

### 2. CIDR

* Classless Inter-Domain Routing
* 가변길이 서브넷 마스크를 기반으로 하는 기술, 근데 약간 다르다.
* 네트워크 마스크가 짧다고 간주함으로써 여러 개의 네트워크에 대한 전송 규칙을 통합하는 기술이다!

![image](./source/vlsm.JPG)


### 3. MAC 주소 

* mac : media access control address
* 물리주소
* 다른 것과 중복되지 않는 유일한 값을 가져야 한다는 것이 원칙
* 16진수 6개의 값으로 표현됨
* 초기 세 개의 값은 제조사를 나타내는 vender id, 그 다음은 기종 id, 마지막 두 개의 값은 시리얼 id
* MAC주소를 고쳐쓰는 제품들이 있다라, 개쳅별로 사용하는 주소가 유일하다는 것이 반드시 보장되지는 않는다

* 이전 이더넷 MAC 주소 사용법
    * 전체에게 동일한 데이터를 보내가 MAC 주소가 자신 앞으로 돼있는 경우에만 수신, 그렇지 않으면 무시하는 구조로 통신이 이뤄진다. 엄청나게 비효율적인 방법

* 현재의 이더넷 MAC 주소 사용법
    * 허브/스위치가 어떤 포트에 어떤 MAC 주소가 연결되어 있는지 기억하고 있으므로, 일종의 port-MAC(key-value) table에서 해당 MAC을 찾아서 해당 기기에만 데이터를 보낸다. 


### 4. ARP가 필요한 이유

* 이더넷 하드웨어 끼리는 MAC 주소 기반 통신
* TCP/IP 통신에서는 IP 주소 사용 
* IP 패킷을 상대에게 보내기 위해 컴퓨터는 상대방의 IP 주소의 네트워크부를 확인한다.

    * 자신의 네트워크와 같은 소속?이면 물리적으로 연결되어 있다고 판단한다. 
        * 그 다음에는 IP 주소에서 MAC 주소를 도출하는 동작을 수행!(여기서도 ARP 사용)

    * 대상이 다른 네트워크에 있는 경우, 그 IP 패킷을 다음 라우터로 넘겨야 한다. 
        * 이때 라우터의 IP 주소에서 MAC 주소를 얻을 필요가 있다. 
        * 이 동작에 ARP(Adrdress Resolution Protocol) 프로토콜이 사용됨
        * 아 이해했다. 라우터는 단지 경유지일 뿐.
        * 그런데 여러 개의 라우터에 연결되어 있을 때, 어느 한 라우터로 연결된 다른 네트워크들 중에 원하는 목적지가 없을 수 있다.
        * DFS나 BFS 방식으로 탐색하는 방식으로 통신-처리가 될라나? 여기서도 아직은 내가 모르는 최적화가 있겠다. 


* ARP에서는 브로드캐스트가 사용된다. 
    * 혹시 너님들, IP가 이건가요?(request)
        * 아니요, 무시한다.
        * 예, 제 IP가 맞습니다. 제 MAC 주소 보내드립니다.(reply)
    * 이러한 방식으로 MAC 주소를 알아낸다.
